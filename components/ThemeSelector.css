.theme-selector {
  position: fixed;
  top: 20px;
  right: 360px;
  z-index: 1000;
}

/* Inline mode for placing inside navbar */
.theme-selector.inline {
  position: relative;
  top: auto;
  right: auto;
  z-index: 2000;
  display: inline-block;
}

.theme-selector.inline .pie-chart-container {
  position: absolute;
  width: 160px;
  height: 160px;
  top: -52px; /* center pie around button */
  left: -52px;
  right: auto;
  z-index: 2001;
  pointer-events: auto;
}

.theme-selector.inline .theme-toggle-btn {
  position: relative;
  z-index: 2002;
}

.theme-toggle-btn {
  width: 56px;
  height: 56px;
  border-radius: 50%;
  border: 3px solid rgba(255, 255, 255, 0.95);
  cursor: pointer;
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  box-shadow: 0 4px 30px rgba(255, 255, 255, 0.4),
    0 0 60px rgba(255, 255, 255, 0.3), inset 0 0 30px rgba(255, 255, 255, 0.15);
  position: relative;
  animation: themePulse 3s ease-in-out infinite,
    themeGlow 2s ease-in-out infinite alternate;
}

/* Vòng sáng xung quanh nút */
.theme-toggle-btn::before {
  content: "";
  position: absolute;
  inset: -8px;
  border-radius: 50%;
  background: conic-gradient(
    from 0deg,
    transparent 0deg,
    rgba(255, 255, 255, 0.4) 90deg,
    transparent 180deg,
    rgba(255, 255, 255, 0.4) 270deg,
    transparent 360deg
  );
  animation: rotateRing 4s linear infinite;
  z-index: -1;
  filter: blur(8px);
}

/* Hiệu ứng sparkle */
.theme-toggle-btn::after {
  content: "✨";
  position: absolute;
  top: -5px;
  right: -5px;
  font-size: 16px;
  animation: sparkle 2s ease-in-out infinite;
  filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.8));
}

.theme-toggle-btn:hover {
  transform: scale(1.15) rotate(15deg);
  box-shadow: 0 8px 32px rgba(255, 255, 255, 0.5),
    0 0 50px rgba(255, 255, 255, 0.4), inset 0 0 30px rgba(255, 255, 255, 0.2);
  border-color: rgba(255, 255, 255, 1);
}

.theme-emoji {
  font-size: 26px;
  animation: float 3s ease-in-out infinite, rotate 6s ease-in-out infinite;
  filter: drop-shadow(0 2px 8px rgba(0, 0, 0, 0.3));
}

/* Animations */
@keyframes float {
  0%,
  100% {
    transform: translateY(0px) scale(1);
  }
  50% {
    transform: translateY(-5px) scale(1.1);
  }
}

@keyframes rotate {
  0%,
  100% {
    transform: rotate(0deg);
  }
  25% {
    transform: rotate(-10deg);
  }
  75% {
    transform: rotate(10deg);
  }
}

@keyframes themePulse {
  0%,
  100% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.05);
  }
}

@keyframes themeGlow {
  0% {
    box-shadow: 0 4px 30px rgba(255, 255, 255, 0.4),
      0 0 60px rgba(255, 255, 255, 0.3),
      inset 0 0 30px rgba(255, 255, 255, 0.15);
  }
  100% {
    box-shadow: 0 8px 50px rgba(255, 255, 255, 0.6),
      0 0 100px rgba(255, 255, 255, 0.5),
      inset 0 0 40px rgba(255, 255, 255, 0.25);
  }
}

@keyframes rotateRing {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

@keyframes sparkle {
  0%,
  100% {
    opacity: 1;
    transform: scale(1) rotate(0deg);
  }
  50% {
    opacity: 0.5;
    transform: scale(1.3) rotate(180deg);
  }
}

/* Dark theme - màu vàng - GLOW MẠNH MẼ */
[data-theme="dark"] .theme-toggle-btn {
  border-color: rgba(255, 215, 0, 1);
  box-shadow: 0 0 20px rgba(255, 215, 0, 0.8), 0 0 40px rgba(255, 215, 0, 0.6),
    0 0 60px rgba(255, 215, 0, 0.4), 0 4px 30px rgba(255, 215, 0, 0.5),
    inset 0 0 30px rgba(255, 215, 0, 0.2);
}

[data-theme="dark"] .theme-toggle-btn::before {
  background: conic-gradient(
    from 0deg,
    rgba(255, 215, 0, 0.8) 0deg,
    rgba(255, 215, 0, 1) 45deg,
    transparent 90deg,
    transparent 180deg,
    rgba(255, 215, 0, 1) 225deg,
    rgba(255, 215, 0, 0.8) 270deg,
    transparent 315deg,
    rgba(255, 215, 0, 0.8) 360deg
  );
}

[data-theme="dark"] .theme-toggle-btn:hover {
  box-shadow: 0 0 30px rgba(255, 215, 0, 1), 0 0 60px rgba(255, 215, 0, 0.8),
    0 0 90px rgba(255, 215, 0, 0.6), 0 8px 50px rgba(255, 215, 0, 0.7),
    inset 0 0 40px rgba(255, 215, 0, 0.3);
}

/* Blue theme - màu xanh dương */
[data-theme="blue"] .theme-toggle-btn {
  border-color: rgba(59, 130, 246, 1);
  box-shadow: 0 0 20px rgba(59, 130, 246, 0.8), 0 0 40px rgba(59, 130, 246, 0.6),
    0 0 60px rgba(59, 130, 246, 0.4), 0 4px 30px rgba(59, 130, 246, 0.5),
    inset 0 0 30px rgba(59, 130, 246, 0.2);
}

[data-theme="blue"] .theme-toggle-btn::before {
  background: conic-gradient(
    from 0deg,
    rgba(59, 130, 246, 0.8) 0deg,
    rgba(59, 130, 246, 1) 45deg,
    transparent 90deg,
    transparent 180deg,
    rgba(59, 130, 246, 1) 225deg,
    rgba(59, 130, 246, 0.8) 270deg,
    transparent 315deg,
    rgba(59, 130, 246, 0.8) 360deg
  );
}

[data-theme="blue"] .theme-toggle-btn:hover {
  box-shadow: 0 0 30px rgba(59, 130, 246, 1), 0 0 60px rgba(59, 130, 246, 0.8),
    0 0 90px rgba(59, 130, 246, 0.6), 0 8px 50px rgba(59, 130, 246, 0.7),
    inset 0 0 40px rgba(59, 130, 246, 0.3);
}

/* Rainbow theme - màu gradient cầu vồng */
[data-theme="rainbow"] .theme-toggle-btn {
  border-color: rgba(255, 107, 157, 1);
  box-shadow: 0 0 20px rgba(255, 107, 157, 0.8),
    0 0 40px rgba(200, 111, 255, 0.7), 0 0 60px rgba(152, 251, 152, 0.5),
    0 4px 30px rgba(255, 107, 157, 0.6), inset 0 0 30px rgba(255, 182, 193, 0.2);
}

[data-theme="rainbow"] .theme-toggle-btn::before {
  background: conic-gradient(
    from 0deg,
    rgba(255, 107, 157, 0.6) 0deg,
    rgba(255, 195, 113, 0.6) 20deg,
    rgba(255, 213, 79, 0.6) 40deg,
    rgba(152, 251, 152, 0.6) 60deg,
    rgba(153, 222, 251, 0.6) 80deg,
    rgba(225, 190, 231, 0.6) 100deg,
    rgba(255, 182, 193, 0.6) 120deg,
    transparent 140deg,
    transparent 360deg
  );
}

[data-theme="rainbow"] .theme-toggle-btn:hover {
  box-shadow: 0 0 30px rgba(255, 107, 157, 1), 0 0 60px rgba(200, 111, 255, 0.9),
    0 0 90px rgba(152, 251, 152, 0.7), 0 8px 50px rgba(255, 107, 157, 0.8),
    inset 0 0 40px rgba(255, 182, 193, 0.3);
}

/* Pink theme - màu hồng */
[data-theme="pink"] .theme-toggle-btn {
  border-color: rgba(255, 107, 157, 1);
  box-shadow: 0 0 20px rgba(255, 107, 157, 0.8),
    0 0 40px rgba(199, 125, 255, 0.7), 0 0 60px rgba(255, 182, 193, 0.5),
    0 4px 30px rgba(255, 107, 157, 0.6), inset 0 0 30px rgba(255, 182, 193, 0.2);
}

[data-theme="pink"] .theme-toggle-btn::before {
  background: conic-gradient(
    from 0deg,
    rgba(255, 107, 157, 0.8) 0deg,
    rgba(255, 107, 157, 1) 45deg,
    transparent 90deg,
    transparent 180deg,
    rgba(199, 125, 255, 1) 225deg,
    rgba(255, 182, 193, 0.8) 270deg,
    transparent 315deg,
    rgba(255, 107, 157, 0.8) 360deg
  );
}

[data-theme="pink"] .theme-toggle-btn:hover {
  box-shadow: 0 0 30px rgba(255, 107, 157, 1), 0 0 60px rgba(199, 125, 255, 0.9),
    0 0 90px rgba(255, 182, 193, 0.7), 0 8px 50px rgba(255, 107, 157, 0.8),
    inset 0 0 40px rgba(255, 182, 193, 0.3);
}

/* Peach theme - màu cam */
[data-theme="peach"] .theme-toggle-btn {
  border-color: rgba(255, 184, 163, 1);
  box-shadow: 0 0 20px rgba(255, 184, 163, 0.8),
    0 0 40px rgba(255, 184, 163, 0.7), 0 0 60px rgba(255, 228, 225, 0.5),
    0 4px 30px rgba(255, 184, 163, 0.6), inset 0 0 30px rgba(255, 228, 225, 0.2);
}

[data-theme="peach"] .theme-toggle-btn::before {
  background: conic-gradient(
    from 0deg,
    rgba(255, 184, 163, 0.8) 0deg,
    rgba(255, 184, 163, 1) 45deg,
    transparent 90deg,
    transparent 180deg,
    rgba(255, 228, 225, 1) 225deg,
    rgba(255, 184, 163, 0.8) 270deg,
    transparent 315deg,
    rgba(255, 184, 163, 0.8) 360deg
  );
}

[data-theme="peach"] .theme-toggle-btn:hover {
  box-shadow: 0 0 30px rgba(255, 184, 163, 1), 0 0 60px rgba(255, 184, 163, 0.9),
    0 0 90px rgba(255, 228, 225, 0.7), 0 8px 50px rgba(255, 184, 163, 0.8),
    inset 0 0 40px rgba(255, 228, 225, 0.3);
}

.pie-chart-container {
  position: absolute;
  top: 60px;
  right: -45px;
  width: 160px;
  height: 160px;
  display: flex;
  align-items: center;
  justify-content: center;
  animation: pieSlideIn 0.3s ease-out;
  overflow: visible;
}

@keyframes pieSlideIn {
  from {
    opacity: 0;
    transform: translateY(-20px) scale(0.8);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.pie-chart {
  filter: drop-shadow(0 8px 24px rgba(0, 0, 0, 0.2));
  transition: transform 0.3s ease;
  overflow: visible;
}

.pie-chart:hover {
  transform: scale(1.05);
}

.pie-slice {
  transition: all 0.3s ease;
}

.pie-slice:hover {
  transform: scale(1.05);
  filter: brightness(1.2) drop-shadow(0 4px 12px rgba(0, 0, 0, 0.3));
}

.pie-slice.active {
  filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.7)) brightness(1.1);
}

.pie-tooltip-new {
  position: absolute;
  top: 50%;
  left: -30%;
  transform: translateX(-50%);
  white-space: nowrap;
  background: rgba(0, 0, 0, 0.85);
  color: white;
  padding: 8px 16px;
  border-radius: 8px;
  font-size: 13px;
  font-weight: 600;
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: 1001;
  pointer-events: none;
  animation: tooltipFadeIn 0.2s ease;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

@keyframes tooltipFadeIn {
  from {
    opacity: 0;
    transform: translateX(-50%) translateY(-5px);
  }
  to {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
  }
}
