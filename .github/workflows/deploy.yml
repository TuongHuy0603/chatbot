- name: Pull code and restart service
  uses: appleboy/ssh-action@v0.1.10
  with:
    host: ${{ secrets.SERVER_HOST }}
    username: ${{ secrets.SERVER_USER }}
    key: ${{ secrets.SERVER_SSH_KEY }}
    script: |
      cd /var/www/chatbot

      echo "ğŸ”„ Resetting local changes..."
      git reset --hard
      git clean -fd

      echo "ğŸ“¥ Pulling latest code from GitHub..."
      git pull origin main

      # echo "ğŸ—ï¸ Building Docker image..."
      # docker build -t chatbot-huy .

      # echo "ğŸ”§ Fixing permissions after build..."
      # sudo chown -R $USER:$USER /var/www/chatbot  # â† SAU BUILD má»›i fix

      echo "ğŸ”„ Restarting service..."
      sudo systemctl restart chatbot_huy.service

      echo "âœ… Checking service status..."
      sudo systemctl status chatbot_huy.service --no-pager

      echo "âœ… Deploy complete!"
